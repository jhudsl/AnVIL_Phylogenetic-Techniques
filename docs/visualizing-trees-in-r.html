<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Visualizing trees in R | Molecular Phylogenetic Techniques</title>
  <meta name="description" content="Description about Course/Book." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Visualizing trees in R | Molecular Phylogenetic Techniques" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Description about Course/Book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Visualizing trees in R | Molecular Phylogenetic Techniques" />
  
  <meta name="twitter:description" content="Description about Course/Book." />
  



<meta name="date" content="2022-06-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/anvil_favicon.ico" type="image/x-icon" />
<link rel="prev" href="phylogenetics-basics.html"/>
<link rel="next" href="what-sequences-should-i-choose.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/AnVIL_style/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<a href="https://anvilproject.org/" target="_blank"><img src="assets/AnVIL_style/logo-anvil.png" style="width: 80%; padding-left: 15px; padding-top: 8px;"</a>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Book</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#anvil-collection"><i class="fa fa-check"></i>AnVIL Collection</a></li>
</ul></li>
<li class="part"><span><b>BOOK OVERVIEW</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#target-audience"><i class="fa fa-check"></i><b>1.2</b> Target Audience</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#curriculum"><i class="fa fa-check"></i><b>1.3</b> Curriculum</a></li>
</ul></li>
<li class="part"><span><b>BEFORE YOU START</b></span></li>
<li class="chapter" data-level="2" data-path="sign-in.html"><a href="sign-in.html"><i class="fa fa-check"></i><b>2</b> Sign in</a></li>
<li class="chapter" data-level="3" data-path="create-a-workspace.html"><a href="create-a-workspace.html"><i class="fa fa-check"></i><b>3</b> Create a workspace</a></li>
<li class="part"><span><b>RUNNING RSTUDIO</b></span></li>
<li class="chapter" data-level="4" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i><b>4</b> Working in RStudio</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rstudio.html"><a href="rstudio.html#launch-rstudio-cloud-environment"><i class="fa fa-check"></i><b>4.1</b> Launch RStudio Cloud Environment</a></li>
<li class="chapter" data-level="4.2" data-path="rstudio.html"><a href="rstudio.html#tour-rstudio"><i class="fa fa-check"></i><b>4.2</b> Tour RStudio</a></li>
<li class="chapter" data-level="4.3" data-path="rstudio.html"><a href="rstudio.html#stopping"><i class="fa fa-check"></i><b>4.3</b> Pause RStudio</a></li>
<li class="chapter" data-level="4.4" data-path="rstudio.html"><a href="rstudio.html#delete-rstudio-cloud-environment"><i class="fa fa-check"></i><b>4.4</b> Delete RStudio Cloud Environment</a></li>
<li class="chapter" data-level="4.5" data-path="rstudio.html"><a href="rstudio.html#video-guide"><i class="fa fa-check"></i><b>4.5</b> Video Guide</a></li>
</ul></li>
<li class="part"><span><b>TREE THINKING</b></span></li>
<li class="chapter" data-level="5" data-path="phylogenetics-basics.html"><a href="phylogenetics-basics.html"><i class="fa fa-check"></i><b>5</b> Phylogenetics basics</a>
<ul>
<li class="chapter" data-level="5.1" data-path="phylogenetics-basics.html"><a href="phylogenetics-basics.html#how-to-read-a-phylogenetic-tree"><i class="fa fa-check"></i><b>5.1</b> How to read a phylogenetic tree</a></li>
<li class="chapter" data-level="5.2" data-path="phylogenetics-basics.html"><a href="phylogenetics-basics.html#outgroups"><i class="fa fa-check"></i><b>5.2</b> Outgroups</a></li>
<li class="chapter" data-level="5.3" data-path="phylogenetics-basics.html"><a href="phylogenetics-basics.html#branch-lengths"><i class="fa fa-check"></i><b>5.3</b> Branch lengths</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualizing-trees-in-r.html"><a href="visualizing-trees-in-r.html"><i class="fa fa-check"></i><b>6</b> Visualizing trees in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualizing-trees-in-r.html"><a href="visualizing-trees-in-r.html#creating-a-newick-object"><i class="fa fa-check"></i><b>6.1</b> Creating a Newick object</a></li>
<li class="chapter" data-level="6.2" data-path="visualizing-trees-in-r.html"><a href="visualizing-trees-in-r.html#drawing-trees"><i class="fa fa-check"></i><b>6.2</b> Drawing trees</a></li>
<li class="chapter" data-level="6.3" data-path="visualizing-trees-in-r.html"><a href="visualizing-trees-in-r.html#adding-outgroups"><i class="fa fa-check"></i><b>6.3</b> Adding outgroups</a></li>
<li class="chapter" data-level="6.4" data-path="visualizing-trees-in-r.html"><a href="visualizing-trees-in-r.html#drawing-trees-multiple-ways"><i class="fa fa-check"></i><b>6.4</b> Drawing trees multiple ways</a></li>
<li class="chapter" data-level="6.5" data-path="visualizing-trees-in-r.html"><a href="visualizing-trees-in-r.html#the-phylo-class"><i class="fa fa-check"></i><b>6.5</b> The <code>phylo</code> class</a></li>
</ul></li>
<li class="part"><span><b>GETTING SEQUENCES</b></span></li>
<li class="chapter" data-level="7" data-path="what-sequences-should-i-choose.html"><a href="what-sequences-should-i-choose.html"><i class="fa fa-check"></i><b>7</b> What sequences should I choose?</a></li>
<li class="chapter" data-level="8" data-path="finding-sequences-in-genbank.html"><a href="finding-sequences-in-genbank.html"><i class="fa fa-check"></i><b>8</b> Finding sequences in GenBank</a>
<ul>
<li class="chapter" data-level="8.1" data-path="finding-sequences-in-genbank.html"><a href="finding-sequences-in-genbank.html#identifying-a-query-sequence-on-genbank"><i class="fa fa-check"></i><b>8.1</b> Identifying a query sequence on GenBank</a></li>
<li class="chapter" data-level="8.2" data-path="finding-sequences-in-genbank.html"><a href="finding-sequences-in-genbank.html#blastn"><i class="fa fa-check"></i><b>8.2</b> blastn</a></li>
<li class="chapter" data-level="8.3" data-path="finding-sequences-in-genbank.html"><a href="finding-sequences-in-genbank.html#identifying-an-outgroup"><i class="fa fa-check"></i><b>8.3</b> Identifying an outgroup</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="downloading-the-sequences-from-genbank.html"><a href="downloading-the-sequences-from-genbank.html"><i class="fa fa-check"></i><b>9</b> Downloading the sequences from GenBank</a>
<ul>
<li class="chapter" data-level="9.1" data-path="downloading-the-sequences-from-genbank.html"><a href="downloading-the-sequences-from-genbank.html#the-dna.bin-object"><i class="fa fa-check"></i><b>9.1</b> The DNA.bin object</a></li>
<li class="chapter" data-level="9.2" data-path="downloading-the-sequences-from-genbank.html"><a href="downloading-the-sequences-from-genbank.html#the-fasta-format"><i class="fa fa-check"></i><b>9.2</b> The fasta format</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<p style="text-align:center;"> <a href="https://github.com/jhudsl/DaSL_Course_Template_Bookdown" target="blank" > This content was published with</a> <a href="https://bookdown.org/" target="blank"> bookdown by: </a> </p>
<p style="text-align:center;"> <a href="http://jhudatascience.org/"> The Johns Hopkins Data Science Lab </a></p>
<a href="http://jhudatascience.org/"><img src="https://jhudatascience.org/images/dasl.png" style=" width: 80%; padding-left: 40px; padding-top: 8px; vertical-align: top "</a>
<p style="text-align:center; font-size: 12px;"> <a href="https://github.com/rstudio4edu/rstudio4edu-book/"> Style adapted from: rstudio4edu-book </a> <a href ="https://creativecommons.org/licenses/by/2.0/"> (CC-BY 2.0) </a></p>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Molecular Phylogenetic Techniques</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <!--script src="https://kit.fontawesome.com/6a26f47516.js"></script-->
  <!--<script src="assets/hideOutput.js"></script>-->
  <link href="assets/AnvIL_style/style.css" rel="stylesheet">
</head>
        


<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/AnVIL_style/dasl_thin_main_image.png">
</div>
<div id="visualizing-trees-in-r" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Visualizing trees in R</h1>
<div id="creating-a-newick-object" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Creating a Newick object</h2>
<p>Computer programs use the Newick tree format for phylogenetic trees. This format uses a series of parentheses, commas, and colons to store information about evolutionary relationships.</p>
<ul>
<li>(A,B) indicates a pair of taxa that form their own group, or <em>clade</em></li>
<li>((A,B),C) indicates the next most closely related taxon to the A-B clade is taxon C</li>
<li>(A:5,B:7) tells the program (and us!) the length of the branch connecting each taxon to the node. In this case, the branch length between the node and A is 5 and the branch length for B is 7. The total distance between A and B is 5+7, or 12.</li>
<li>((A,B),C)); tells the program the tree is complete. If the semicolon is missing at the end, the program will keep looking for information on another taxon.</li>
</ul>
<p>For this exercise, we are going to create an R object in Newick formula that illustrates the relationships among several species of mammals.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="visualizing-trees-in-r.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;ape&#39;) #this installs the ape package</span></span>
<span id="cb8-2"><a href="visualizing-trees-in-r.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;nlme&#39;) #this installs the nlme package</span></span>
<span id="cb8-3"><a href="visualizing-trees-in-r.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape) <span class="co">#this opens the ape package</span></span>
<span id="cb8-4"><a href="visualizing-trees-in-r.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme) <span class="co">#this opens the nlme package</span></span>
<span id="cb8-5"><a href="visualizing-trees-in-r.html#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="visualizing-trees-in-r.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#we first create an object that stores the tree information</span></span>
<span id="cb8-7"><a href="visualizing-trees-in-r.html#cb8-7" aria-hidden="true" tabindex="-1"></a>mammal<span class="fl">.1</span> <span class="ot">&lt;-</span>  <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&quot;((((raccoon:19.19959,bear:6.80041):0.84600,</span></span>
<span id="cb8-8"><a href="visualizing-trees-in-r.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="st">             weasel:18.87953):2.09460):3.87382,dog:25.46154);&quot;</span>)</span>
<span id="cb8-9"><a href="visualizing-trees-in-r.html#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="visualizing-trees-in-r.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#typing the name of the object means R will tell us about it</span></span>
<span id="cb8-11"><a href="visualizing-trees-in-r.html#cb8-11" aria-hidden="true" tabindex="-1"></a>mammal<span class="fl">.1</span></span></code></pre></div>
<pre><code>## 
## Phylogenetic tree with 4 tips and 4 internal nodes.
## 
## Tip labels:
##   raccoon, bear, 
## weasel, dog
## 
## Rooted; includes branch lengths.</code></pre>
<p>We now have a phylogenetic tree loaded into R.</p>
<div class="fyi">
<p>Why is it called Newick format?</p>
<p>This is what Joe Felsenstein, one of the giants of the phylogenetic field, says:
“The Newick Standard was adopted 26 June 1986 by an informal committee meeting convened by me during the Society for the Study of Evolution meetings in Durham, New Hampshire and consisting of James Archie, William H.E. Day, Wayne Maddison, Christopher Meacham, F. James Rohlf, David Swofford, and myself. (The committee was not an activity of the SSE nor endorsed by it). The reason for the name is that the second and final session of the committee met at Newick’s restaurant in Dover, New Hampshire, and we enjoyed the meal of lobsters. The tree representation was a generalization of one developed by Christopher Meacham in 1984 for the tree plotting programs that he wrote for the PHYLIP package while visiting Seattle. His visit was a sabbatical leave from the University of Georgia, which thus indirectly partly funded that work.”</p>
</div>
</div>
<div id="drawing-trees" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Drawing trees</h2>
<p>It is quite difficult for humans to quickly interpret the relationships and branch lengths in the Newick format. Luckily, R (and other phylogenetics programs) can convert Newick formats into a more understandable form.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="visualizing-trees-in-r.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot is the command we use to create trees with the ape package</span></span>
<span id="cb10-2"><a href="visualizing-trees-in-r.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#one of the options is the type of tree the command draws</span></span>
<span id="cb10-3"><a href="visualizing-trees-in-r.html#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="visualizing-trees-in-r.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#this can also be written as plot(mammal.1, &quot;u&quot;)</span></span>
<span id="cb10-5"><a href="visualizing-trees-in-r.html#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal<span class="fl">.1</span>, <span class="at">type=</span><span class="st">&quot;unrooted&quot;</span>)</span></code></pre></div>
<p><img src="resources/images/03-tree-thinking_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>You’ve inferred an unrooted tree. It probably looks a bit different than trees you’ve seen before (including the one in the previous section); most trees are displayed in a rooted form. We can do that by specifying that we want to draw a phylogram. If you don’t declare an outgroup first, R will choose to root the phylogram halfway between the two longest branches (this is called midpoint rooting).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="visualizing-trees-in-r.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#here we draw a phylogram</span></span>
<span id="cb11-2"><a href="visualizing-trees-in-r.html#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="visualizing-trees-in-r.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#alternatively, you can use the command: </span></span>
<span id="cb11-4"><a href="visualizing-trees-in-r.html#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(plot(mammal.1), as phylogram is the default type</span></span>
<span id="cb11-5"><a href="visualizing-trees-in-r.html#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal<span class="fl">.1</span>, <span class="at">type=</span><span class="st">&quot;phylogram&quot;</span>)</span></code></pre></div>
<p><img src="resources/images/03-tree-thinking_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Now the tree looks more like the Ursidae tree we examined earlier. The order of the tips is partly determined by the order in which we wrote the taxa in our Newick format. We can change the order of the tips and still have the same tree.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="visualizing-trees-in-r.html#cb12-1" aria-hidden="true" tabindex="-1"></a>mammal<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&quot;((((bear:6.80041,raccoon:19.19959):0.84600,</span></span>
<span id="cb12-2"><a href="visualizing-trees-in-r.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="st">             weasel:18.87953):2.09460):3.87382,dog:25.46154);&quot;</span>)</span>
<span id="cb12-3"><a href="visualizing-trees-in-r.html#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="visualizing-trees-in-r.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#this bit of code here tells R to put the trees in side-by-side in</span></span>
<span id="cb12-5"><a href="visualizing-trees-in-r.html#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#a single row (1 row, 2 columns)</span></span>
<span id="cb12-6"><a href="visualizing-trees-in-r.html#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb12-7"><a href="visualizing-trees-in-r.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal<span class="fl">.1</span>)</span>
<span id="cb12-8"><a href="visualizing-trees-in-r.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal<span class="fl">.2</span>)</span></code></pre></div>
<p><img src="resources/images/03-tree-thinking_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Clades can rotate freely around nodes without changing the relationships among the tips. Although the “weasel” label is closer to “bear” in our first tree than it is in the second tree, the evolutionary distance between the two is the same in both trees, because we trace through the same nodes to find their common ancestor. <strong>Both of these trees are exactly the same, in a phylogenetic sense.</strong></p>
</div>
<div id="adding-outgroups" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Adding outgroups</h2>
<p>Let’s add some more taxa to our tree!</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="visualizing-trees-in-r.html#cb13-1" aria-hidden="true" tabindex="-1"></a>mammal<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&quot;((raccoon:19.19959,bear:6.80041):0.84600,((sea_lion:11.99700,</span></span>
<span id="cb13-2"><a href="visualizing-trees-in-r.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="st">            seal:12.00300):7.52973,((monkey:100.85930,cat:47.14069):20.59201,</span></span>
<span id="cb13-3"><a href="visualizing-trees-in-r.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="st">            weasel:18.87953):2.09460):3.87382,dog:25.46154);&quot;</span>)</span>
<span id="cb13-4"><a href="visualizing-trees-in-r.html#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="visualizing-trees-in-r.html#cb13-5" aria-hidden="true" tabindex="-1"></a>mammal<span class="fl">.3</span></span></code></pre></div>
<pre><code>## 
## Phylogenetic tree with 8 tips and 6 internal nodes.
## 
## Tip labels:
##   raccoon, bear, sea_lion, 
## seal, monkey, cat, ...
## 
## Unrooted; includes branch lengths.</code></pre>
<p>We’ve now added an additional 5 taxa to our tree of mammalian species. Let’s first take a look at the unrooted tree.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="visualizing-trees-in-r.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal<span class="fl">.3</span>, <span class="at">type=</span><span class="st">&quot;u&quot;</span>)<span class="co">#&quot;u&quot; is short for &quot;unrooted&quot;</span></span></code></pre></div>
<p><img src="resources/images/03-tree-thinking_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Even with the unrooted tree, we can see that some species are definitely more closely related than others. In fact, it looks like both “cat” and “monkey” are pretty distantly related to the others, since the branches connecting these taxa are much longer than any other branch. Given this information, we will define these two taxa as our outgroup and redraw our tree, this time as a rooted phylogram.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="visualizing-trees-in-r.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#this command tells R that monkey and cat are outgroups</span></span>
<span id="cb16-2"><a href="visualizing-trees-in-r.html#cb16-2" aria-hidden="true" tabindex="-1"></a>mammal.<span class="fl">3.</span>root <span class="ot">&lt;-</span> <span class="fu">root</span>(mammal<span class="fl">.3</span>, <span class="at">outgroup =</span> <span class="fu">c</span>(<span class="st">&#39;monkey&#39;</span>,<span class="st">&#39;cat&#39;</span>))</span>
<span id="cb16-3"><a href="visualizing-trees-in-r.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="visualizing-trees-in-r.html#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal.<span class="fl">3.</span>root, <span class="at">type=</span><span class="st">&quot;p&quot;</span>)<span class="co">#&quot;p&quot; is short for &quot;phylogram&quot;</span></span></code></pre></div>
<p><img src="resources/images/03-tree-thinking_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="drawing-trees-multiple-ways" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Drawing trees multiple ways</h2>
<p>So far you’ve drawn trees in two ways - unrooted, and as a phylogram. For both of these tree types, the branch lengths are scaled to indicate evolutionary distance (or how many changes have occurred). As a result, the tips aren’t all even with each other.</p>
<p>There are two other common ways of drawing trees. The radial tree (sometimes called the fan tree) arranges all the branches in a circle. This is a popular way to draw a phylogeny with many tips that would otherwise take up a lot of space.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="visualizing-trees-in-r.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#now we&#39;re looking at three different trees next to each other</span></span>
<span id="cb17-2"><a href="visualizing-trees-in-r.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#basically, figures are in 1 row and 3 columns</span></span>
<span id="cb17-3"><a href="visualizing-trees-in-r.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb17-4"><a href="visualizing-trees-in-r.html#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal<span class="fl">.3</span>, <span class="at">type=</span><span class="st">&quot;u&quot;</span>)</span>
<span id="cb17-5"><a href="visualizing-trees-in-r.html#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal.<span class="fl">3.</span>root, <span class="at">type=</span><span class="st">&quot;p&quot;</span>)</span>
<span id="cb17-6"><a href="visualizing-trees-in-r.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal.<span class="fl">3.</span>root, <span class="at">type=</span><span class="st">&quot;f&quot;</span>)<span class="co">#f is short for &quot;fan&quot;</span></span></code></pre></div>
<p><img src="resources/images/03-tree-thinking_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>All three of these trees show exactly the same information.</p>
<p>The last common way to draw trees is as a cladogram. Cladograms are a little different than the others, because the branches are not scaled to evolutionary distance. Instead, the tree is drawn so that all the tips (taxa) are lined up. It is often easier to see relationships in a cladogram, particularly if the internode distances (the distance between two internal nodes of a tree) are small.</p>
<p>To properly draw a cladogram, we will rewrite our tree in Newick formula so that it doesn’t include branch lengths.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="visualizing-trees-in-r.html#cb18-1" aria-hidden="true" tabindex="-1"></a>mammal<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">read.tree</span>(<span class="at">text =</span> <span class="st">&quot;(dog,(raccoon,bear),((seal,sea_lion),</span></span>
<span id="cb18-2"><a href="visualizing-trees-in-r.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="st">            ((monkey,cat), weasel)));&quot;</span>)</span>
<span id="cb18-3"><a href="visualizing-trees-in-r.html#cb18-3" aria-hidden="true" tabindex="-1"></a>mammal.<span class="fl">4.</span>root <span class="ot">&lt;-</span> <span class="fu">root</span>(mammal<span class="fl">.4</span>, <span class="at">outgroup =</span> <span class="fu">c</span>(<span class="st">&#39;monkey&#39;</span>,<span class="st">&#39;cat&#39;</span>))</span>
<span id="cb18-4"><a href="visualizing-trees-in-r.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="visualizing-trees-in-r.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-6"><a href="visualizing-trees-in-r.html#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal.<span class="fl">3.</span>root, <span class="at">type=</span><span class="st">&quot;p&quot;</span>)</span>
<span id="cb18-7"><a href="visualizing-trees-in-r.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mammal.<span class="fl">4.</span>root, <span class="at">type=</span><span class="st">&quot;c&quot;</span>)<span class="co">#c is short for &quot;cladogram&quot;</span></span></code></pre></div>
<p><img src="resources/images/03-tree-thinking_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="fyi">
<p>QUESTIONS</p>
<ol style="list-style-type: decimal">
<li><p>What is the total branch length between “bear” and “raccoon”? (You will need to look at the tree in Newick format.)</p></li>
<li><p>Does “weasel” share a more common recent ancestor with “seal” or with “sea lion”?</p></li>
<li><p>Why does it look like “weasel” is more closely related to “bear” in the tree with four taxa, but it looks like “dog” is more closely related to “bear” in the tree with eight taxa? (HINT: Think about the purpose of an outgroup, and whether we specified one for the four-taxa tree.)</p></li>
</ol>
</div>
</div>
<div id="the-phylo-class" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> The <code>phylo</code> class</h2>
<p>When we use the <code>ape</code> package, R converts a tree in Newick format to an object of the <code>phylo</code> class. This is basically a list of four dataframes.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="visualizing-trees-in-r.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mammal.<span class="fl">3.</span>root)</span></code></pre></div>
<pre><code>## List of 4
##  $ edge       : int [1:13, 1:2] 9 14 12 10 11 11 10 12 13 13 ...
##  $ edge.length: num [1:13] 20.592 2.095 3.874 0.846 19.2 ...
##  $ Nnode      : int 6
##  $ tip.label  : chr [1:8] &quot;raccoon&quot; &quot;bear&quot; &quot;sea_lion&quot; &quot;\nseal&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;phylo&quot;
##  - attr(*, &quot;order&quot;)= chr &quot;cladewise&quot;</code></pre>
<p>Each dataframe holds information about some part of the tree.</p>
<p><em>edge</em>: the number of steps needed to connect two tips. It’s easiest to think of each branch as an edge.</p>
<p><em>edge.length</em>: the length of each corresponding edge, or branch</p>
<p><em>Nnode</em>: the number of nodes in the tree</p>
<p><em>tip.label</em>: the tip names (the taxa)</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="visualizing-trees-in-r.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.0.2 (2020-06-22)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.3 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] nlme_3.1-149 ape_5.4-1   
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.8      knitr_1.33      magrittr_2.0.2  hms_0.5.3      
##  [5] lattice_0.20-41 R6_2.4.1        rlang_0.4.10    highr_0.8      
##  [9] stringr_1.4.0   tools_4.0.2     parallel_4.0.2  grid_4.0.2     
## [13] xfun_0.26       jquerylib_0.1.4 htmltools_0.5.0 ellipsis_0.3.1 
## [17] ottrpal_0.1.2   yaml_2.2.1      digest_0.6.25   tibble_3.0.3   
## [21] lifecycle_1.0.0 crayon_1.3.4    bookdown_0.24   readr_1.4.0    
## [25] vctrs_0.3.4     fs_1.5.0        evaluate_0.14   rmarkdown_2.10 
## [29] stringi_1.5.3   compiler_4.0.2  pillar_1.4.6    pkgconfig_2.0.3</code></pre>

</div>
</div>



<hr>
<center> 
  <div class="footer">
      All illustrations <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY. </a>
      <br>
      All other materials <a href= "https://creativecommons.org/licenses/by/4.0/"> CC-BY </a> unless noted otherwise.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="phylogenetics-basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="what-sequences-should-i-choose.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
